{% load static %}
<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <title>ÎšÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚</title>
  <link rel="stylesheet" href="{% static 'rentals/style.css' %}">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    .toolbar{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem}
    .btn{padding:.55rem .9rem;border:1px solid #ddd;border-radius:.5rem;cursor:pointer;background:#111;color:#fff}
    .btn.light{background:#fff;color:#111}
    .btn.danger{background:#b00020;color:#fff;border-color:#9a001c}
    table{width:100%;border-collapse:collapse}
    th,td{padding:.5rem;border-bottom:1px solid #eee;text-align:left;vertical-align:middle}
    .status{padding:.2rem .5rem;border-radius:.4rem;font-size:.85rem}
    .status.imported{background:#f0f4ff}
    .status.active{background:#fff7e6}
    .status.completed{background:#e9fbe9}
    .status.cancelled{background:#fdeaea}
    .muted{color:#666}
    .select-col{width:44px;text-align:center}
    input[type="checkbox"]{transform:scale(1.2)}
  </style>
</head>
<body>

  <!-- Î•Ï€Î¬Î½Ï‰ actions -->
  <div class="toolbar">
    <a class="btn light" href="{% url 'rentals:home' %}">â† Î Î¯ÏƒÏ‰ ÏƒÏ„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ®</a>
    <a class="btn light" href="{% url 'rentals:booking_create' %}">â• ÎÎ­Î± ÎºÏÎ¬Ï„Î·ÏƒÎ· (manual)</a>
  </div>

  <!-- Î¦Î¯Î»Ï„ÏÎ± (GET) -->
  <form method="get" class="toolbar">
    {{ filter_form.status }}
    Î‘Ï€ÏŒ: {{ filter_form.start_from }}
    ÎˆÏ‰Ï‚: {{ filter_form.end_to }}
    <button class="btn light" type="submit">Î¦Î¯Î»Ï„ÏÎ¿</button>
  </form>

  <!-- ÎœÎ±Î¶Î¹ÎºÎ® Î´Î¹Î±Î³ÏÎ±Ï†Î® (POST) -->
  <form method="post" id="bulk-delete-form" onsubmit="return confirm('ÎÎ± Î´Î¹Î±Î³ÏÎ±Ï†Î¿ÏÎ½ Î¿Î¹ ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½ÎµÏ‚ ÎºÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚;');">
    {% csrf_token %}

    <div class="toolbar" style="justify-content:flex-end">
      <button class="btn danger" type="submit" name="action" value="delete_selected">ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Ï‰Î½</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Î ÎµÎ»Î¬Ï„Î·Ï‚</th>
          <th>ÎŒÏ‡Î·Î¼Î±</th>
          <th>Î—Î¼/Î½Î¯ÎµÏ‚</th>
          <th>Î Î¿ÏƒÏŒ</th>
          <th>Status</th>
          <th>Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</th>
          <th class="select-col">
            <input type="checkbox" id="select-all" title="Î•Ï€Î¹Î»Î¿Î³Î® ÏŒÎ»Ï‰Î½">
          </th>
        </tr>
      </thead>
      <tbody>
        {% for b in bookings %}
        <tr>
          <td>{{ b.id }}</td>
          <td>{{ b.customer_name }}<div class="muted">{{ b.customer_phone }}</div></td>
          <td>{{ b.car.brand }} {{ b.car.model }}</td>
          <td>{{ b.start_date }} â†’ {{ b.end_date }}</td>
          <td>{{ b.total_price }} â‚¬</td>
          <td>
            <span class="status {{ b.status }}">
              {% if b.status == 'imported' %}Î•Î¹ÏƒÎ±Î³ÏŒÎ¼ÎµÎ½Î·{% endif %}
              {% if b.status == 'active' %}Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·{% endif %}
              {% if b.status == 'completed' %}ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ{% endif %}
              {% if b.status == 'cancelled' %}Î‘ÎºÏ…ÏÏÎ¸Î·ÎºÎµ{% endif %}
            </span>
          </td>
          <td>
            {% if b.status == 'imported' %}
              <a class="btn light" href="{% url 'rentals:booking_start' b.id %}">Start</a>
              <a class="btn light" href="{% url 'rentals:booking_cancel' b.id %}">Cancel</a>
            {% elif b.status == 'active' %}
              <a class="btn light" href="{% url 'rentals:booking_complete' b.id %}">Complete</a>
              <a class="btn light" href="{% url 'rentals:booking_cancel' b.id %}">Cancel</a>
            {% else %}
              â€”
            {% endif %}
          </td>
          <td class="select-col">
            <input type="checkbox" name="selected_bookings" value="{{ b.id }}" class="row-check">
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="8" class="muted">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </form>

  <script>
    // select-all
    const selectAll = document.getElementById('select-all');
    const checks = document.querySelectorAll('.row-check');
    if (selectAll) {
      selectAll.addEventListener('change', e => {
        checks.forEach(ch => ch.checked = e.target.checked);
      });
    }
  </script>

</body>
</html>
